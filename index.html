<!DOCTYPE html>
<html>

<head>
    <title>Streetscape</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/styles.css">
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <!-- Leaflet.draw CSS (optional) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.4/leaflet.draw.css" />
    <link rel="stylesheet" href="https://ppete2.github.io/Leaflet.PolylineMeasure/Leaflet.PolylineMeasure.css" />
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
    <link rel="manifest" href="site.webmanifest">
    <script src="https://maps.googleapis.com/maps/api/js?key=" async defer></script>
</head>

<body>
    <div id="map"></div>
    <div id="control">
        <!-- Editable Project Name -->
        <div id="projectHeader">
            <span id="projectNameLabel" style="font-size: 0.8rem; cursor: pointer;">
                My Project</span>
            <span id="projectNameEdit" style="cursor: pointer;display:inline-block">
                <svg width="10px" height="10px" xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 512 512"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.-->
                    <path
                        d="M471.6 21.7c-21.9-21.9-57.3-21.9-79.2 0L362.3 51.7l97.9 97.9 30.1-30.1c21.9-21.9 21.9-57.3 0-79.2L471.6 21.7zm-299.2 220c-6.1 6.1-10.8 13.6-13.5 21.9l-29.6 88.8c-2.9 8.6-.6 18.1 5.8 24.6s15.9 8.7 24.6 5.8l88.8-29.6c8.2-2.7 15.7-7.4 21.9-13.5L437.7 172.3 339.7 74.3 172.4 241.7zM96 64C43 64 0 107 0 160L0 416c0 53 43 96 96 96l256 0c53 0 96-43 96-96l0-96c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 96c0 17.7-14.3 32-32 32L96 448c-17.7 0-32-14.3-32-32l0-256c0-17.7 14.3-32 32-32l96 0c17.7 0 32-14.3 32-32s-14.3-32-32-32L96 64z" />
                </svg>
            </span>
            <input type="text" id="projectNameInput" value="My Project" style="display:none;">
            <button id="projectNameOk" style="display:none;">OK</button>
            <div id="collapseButton" style="position: absolute; top: 10px; right: 10px; cursor: pointer;">
                <svg width="16px" height="16px" xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 448 512"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.-->
                    <path
                        d="M0 96C0 78.3 14.3 64 32 64l384 0c17.7 0 32 14.3 32 32s-14.3 32-32 32L32 128C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32l384 0c17.7 0 32 14.3 32 32s-14.3 32-32 32L32 288c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32L32 448c-17.7 0-32-14.3-32-32s14.3-32 32-32l384 0c17.7 0 32 14.3 32 32z" />
                </svg>
            </div>
        </div>
        <div id="tabs">
            <button id="tabMarkings" class="tab active">Traffic Control</button>
            <button id="tabLaneLines" class="tab">Line Markings</button>
            <button id="tabPavementColor" class="tab">Pavements</button>
            <button id="tabProjectSettings" class="tab">Project Settings</button>
        </div>
        <div id="pavementTab" class="tabContent"><!-- Pavement Markings Tab -->
        <div id="selectedIconInfo" style="margin: 10px 0; font-weight: bold;">Selected Icon: None</div>
        Ground Marking
            <div id="iconOptions">
                <button class="iconButton" data-icon="img/bikelane.png">
                    <img src="img/bikelane.png" alt="Bike Lane" style="width: 30px;">
                </button>
                <button class="iconButton" data-icon="img/bikelane-green.png">
                    <img src="img/bikelane-green.png" alt="Bike Lane green" style="width: 30px;">
                </button>
                <button class="iconButton" data-icon="img/sharrow.png">
                    <img src="img/sharrow.png" alt="Sharrow" style="width: 30px;">
                </button>
                <button class="iconButton" data-icon="img/sharrow-green.png">
                    <img src="img/sharrow-green.png" alt="Sharrow green" style="width: 30px;">
                </button>
                <button class="iconButton" data-icon="img/bike-symbol.png">
                    <img src="img/bike-symbol.png" alt="Bike symbol" style="width: 30px;">
                </button>
                <button class="iconButton" data-icon="img/onlybus-red.png">
                    <img src="img/onlybus-red.png" alt="Only Bus" style="width: 30px;">
                </button>
                <button class="iconButton" data-icon="img/onlybus.png">
                    <img src="img/onlybus.png" alt="Only Bus" style="width: 30px;">
                </button>
                <button class="iconButton" data-icon="img/parking.png">
                    <img src="img/parking.png" alt="Parking" style="width: 30px;">
                </button>
                <button class="iconButton" data-icon="img/speed-table.png">
                    <img src="img/speed-table.png" alt="Speed table" style="width: 30px;">
                </button>
                <button class="iconButton" data-icon="img/bike-conflict-zone.svg">
                    <img src="img/bike-conflict-zone.svg" alt="Green bike conflict zone" style="width: 34px;">
                </button>
                <button class="iconButton" data-icon="img/left-turn-bike-box.png">
                    <img src="img/left-turn-bike-box.png" alt="Left turn bike box" style="width: 34px;">
                </button>
                <button class="iconButton" data-icon="img/ada_ramp.png">
                    <img src="img/ada_ramp.png" alt="ADA ramp" style="width: 30px;">
                </button>
                <!-- <button class="iconButton" data-icon="img/twlt.png">
                    <img src="img/twlt.png" alt="Two-way turn lane" style="width: 30px;">
                </button> -->
                <button class="iconButton" data-icon="img/through.png">
                    <img src="img/through.png" alt="Through lane" style="width: 30px;">
                </button>
                <button class="iconButton" data-icon="img/left.png">
                    <img src="img/left.png" alt="Left turn" style="width: 30px;">
                </button>
                <button class="iconButton" data-icon="img/right.png">
                    <img src="img/right.png" alt="Right turn" style="width: 30px;">
                </button>
                <button class="iconButton" data-icon="img/left-through.png">
                    <img src="img/left-through.png" alt="Left-through turn" style="width: 30px;">
                </button>
                <button class="iconButton" data-icon="img/right-through.png">
                    <img src="img/right-through.png" alt="Right-through turn" style="width: 30px;">
                </button>
                <button class="iconButton" data-icon="img/uturn-left.png">
                    <img src="img/uturn-left.png" alt="U-turn and left turn" style="width: 30px;">
                </button>
                <button class="iconButton" data-icon="img/bike-racks.png">
                    <img src="img/bike-racks.png" alt="Bike corral" style="width: 42px;">
                </button>
                <button class="iconButton" data-icon="img/football.png">
                    <img src="img/football.png" alt="Protected intersection curb" style="width: 30px;">
                </button>
                <button class="iconButton" data-icon="img/vertical-delineator_1010.svg?w=10&h=10">
                    <img src="img/vertical-delineator_1010.svg?w=10&h=10" alt="Vertical delineator" style="width: 30px;">
                </button>
                <button class="iconButton" data-icon="img/left-small.png">
                    <img src="img/left-small.png" alt="Left turn (small)" style="width: 30px;">
                </button>
                <button class="iconButton" data-icon="img/bike-symbol-2.png">
                    <img src="img/bike-symbol-2.png" alt="Bike Symbol 2" style="width: 30px;">
                </button>
            </div>
            <p></p>Sign/Signal Control
            <div id="iconOptions">
                <button class="iconButton sign" data-icon="img/MUTCD_R10-11.png">
                    <img src="img/MUTCD_R10-11.png" alt="No turn on red" style="width: 30px;">
                </button>
                <button class="iconButton sign" data-icon="img/MUTCD_R1-1.svg.png">
                    <img src="img/MUTCD_R1-1.svg.png" alt="Stop sign" style="width: 30px;">
                </button>
                <button class="iconButton sign" data-icon="img/MUTCD_R6-2R.svg.png">
                    <img src="img/MUTCD_R6-2R.svg.png" alt="One way right" style="width: 30px;">
                </button>
                <button class="iconButton sign" data-icon="img/MUTCD_R6-2L.svg.png">
                    <img src="img/MUTCD_R6-2L.svg.png" alt="One way left" style="width: 30px;">
                </button>
                <button class="iconButton sign" data-icon="img/MUTCD_R5-1.svg.png">
                    <img src="img/MUTCD_R5-1.svg.png" alt="Do not enter sign" style="width: 30px;">
                </button>
                <button class="iconButton sign" data-icon="img/MUTCD_W1-7.svg.png">
                    <img src="img/MUTCD_W1-7.svg.png" alt="W1-7 Two-direction large arrow sign" style="width: 30px;">
                </button>
                <button class="iconButton sign" data-icon="img/MUTCD_R3-17.svg.png">
                    <img src="img/MUTCD_R3-17.svg.png" alt="R3-17 Bike lane sign" style="width: 30px;">
                </button>
                <button class="iconButton sign" data-icon="img/MUTCD_R7-9a.svg.png">
                    <img src="img/MUTCD_R7-9a.svg.png" alt="R7-9a No parking, bike lane" style="width: 30px;">
                </button>
                <button class="iconButton sign" data-icon="img/MUTCD_R7-1R.svg.png">
                    <img src="img/MUTCD_R7-1R.svg.png" alt="R7-1R No parking to the right" style="width: 30px;">
                </button>
                <button class="iconButton sign" data-icon="img/MUTCD_R7-1L.svg.png">
                    <img src="img/MUTCD_R7-1L.svg.png" alt="R7-1L No parking to the left" style="width: 30px;">
                </button>
                <button class="iconButton sign" data-icon="img/MUTCD_D4-1L.svg.png">
                    <img src="img/MUTCD_D4-1L.svg.png" alt="D4-1L Parking area left" style="width: 30px;">
                </button>
                <button class="iconButton sign" data-icon="img/MUTCD_D4-1R.svg.png">
                    <img src="img/MUTCD_D4-1R.svg.png" alt="D4-1L Parking area right" style="width: 30px;">
                </button><button class="iconButton sign" data-icon="img/MUTCD_W11-15_(fluorescent).svg.png">
                    <img src="img/MUTCD_W11-15_(fluorescent).svg.png" alt="W11-15
Bicycle and pedestrians" style="width: 30px;">
                </button>
                <button class="iconButton sign" data-icon="img/MUTCD_W16-7PL_(fluorescent).svg.png">
                    <img src="img/MUTCD_W16-7PL_(fluorescent).svg.png" alt="W16-7PL
Downward diagonal arrow to the left " style="width: 30px;">
                </button>
                <button class="iconButton sign" data-icon="img/MUTCD_W4-4P.svg.png">
                    <img src="img/MUTCD_W4-4P.svg.png" alt="W4-4P
Cross traffic does not stop " style="width: 30px;">
                </button>
                
            </div>
            <div id="angleSelector">
                <svg id="angleSVG" width="100" height="100" viewBox="0 0 100 100">
                    <circle cx="50" cy="50" r="40" stroke="#ccc" stroke-width="2" fill="none" />
                    <line id="angleLine" x1="50" y1="50" x2="50" y2="10" stroke="red" stroke-width="2" />
                </svg>
                <div id="angleValue">0째</div>
                <button id="angle180Button">Flip 180째 (F)</button>
            </div>
            <button id="removeMarker">Remove Selected Marker (R)</button>
            <button id="addTextLabel">Add Text Label (T)</button>
            <button id="addCalloutLine">Add Callout Line (C)</button>
        </div>
        <!-- Lane Lines Tab -->
        <div id="laneTab" class="tabContent" style="display: none;">
            <div>
                <!-- Lane Color -->
                <label>Lane Color:</label><br>
                <label>
                    <input type="radio" name="laneColor" value="#ffffff" checked>
                    White
                </label>
                <label>
                    <input type="radio" name="laneColor" value="#ffff00">
                    Yellow
                </label><label>
                    <input type="radio" name="laneColor" value="#ff0000">
                    Red
                </label><br>

                <!-- Lane Width -->
                <label>Lane Width:</label><br>
                <label>
                    <input type="radio" name="laneWidth" value="3" checked>
                    <span style="display: inline-block; width: 50px; height: 3px; background: black; vertical-align: middle;"></span> 6"
                </label><br>
                <label>
                    <input type="radio" name="laneWidth" value="10">
                    <span style="display: inline-block; width: 50px; height: 10px; background: black; vertical-align: middle;"></span> 2'
                </label><br>

                <!-- Lane Dash -->
                <label>Lane Style:</label><br>
                <label>
                    <input type="radio" name="laneDash" value="" checked>
                    <span style="display: inline-block; width: 50px; height: 3px; background: black; vertical-align: middle;"></span> Solid
                </label><br>
                <label>
                    <input type="radio" name="laneDash" value="60,150">
                    <span style="display: inline-block; width: 50px; height: 3px; background: repeating-linear-gradient(90deg, black 0, black 10px, transparent 10px, transparent 25px); vertical-align: middle;"></span> Long Dashed
                </label><br>
                <label>
                    <input type="radio" name="laneDash" value="20,60">
                    <span style="display: inline-block; width: 50px; height: 3px; background: repeating-linear-gradient(90deg, black 0, black 5px, transparent 5px, transparent 15px); vertical-align: middle;"></span> Short Dashed
                </label>
            </div>
            <button id="drawLaneLine">Draw New Line (L)</button>
            <!-- <button id="editLaneLine">Edit Selected Lane Line</button> -->
            <!-- <button id="saveLaneLineEdits">Save Lane Line Edits</button> -->
            <button id="removeLaneLine">Remove Selected Line (R)</button>
            <button id="newOffsetLine">New Offset Line (O)</button>
            <button id="calcRadius">Calculate Radius</button>
        </div>
        <!-- Pavement Color Tab -->
        <div id="pavementColorTab" class="tabContent" style="display: none;">
            <div>
                <label for="pavementStroke">Stroke Color:</label>
                <input type="color" id="pavementStroke" value="#222222"><br>
                
                <label for="pavementFill">Polygon Color:</label>
                <input type="color" id="pavementFill" value="#222222" list="pavementFillColors">
                <datalist id="pavementFillColors">
                    <option value="#000000">Black</option>
                    <option value="#808080">Gray</option>
                    <option value="#FFFFFF">White</option>
                    <option value="#FF0000">Red</option>
                    <option value="#008000">Green</option>
                    <option value="#FFFF00">Yellow</option>
                    <option value="#0000FF">Blue</option>
                </datalist><br>
                <label for="pavementFillOpacity">Polygon Opacity:</label>
                <input type="range" id="pavementFillOpacity" min="0" max="1" step="0.1" value="1">
                <span id="pavementFillOpacityValue">1</span>
            </div>
            <div id="pavementArea" style="margin-top: 10px; font-weight: bold;"></div>
            <button id="drawPavementPolygon">New Polygon Shape</button>
            <button id="editPavementPolygon">Edit/Drag Selected Polygon</button>
            <button id="movePolygonBackward">Move Polygon Backward</button>
            <button id="movePolygonForward">Move Polygon Forward</button>
            <button id="removePavementPolygon">Remove Selected Polygon</button>
            <center><div id="polygonAngleSelector">
                <svg id="polygonAngleSVG" width="100" height="100" viewBox="0 0 100 100">
                    <circle cx="50" cy="50" r="40" stroke="#ccc" stroke-width="2" fill="none" />
                    <line id="polygonAngleLine" x1="50" y1="50" x2="50" y2="10" stroke="blue" stroke-width="2" />
                </svg>
                <div id="polygonAngleValue">0째</div>
                <button id="polygonAngle180Button">Flip 180째</button>
            </div></center>
        </div>
        <!-- Project Settings Tab -->
        <div id="projectSettingsTab" class="tabContent" style="display: none;">
            <div style="display: none;">
                <label for="initialLat">Load Latitude:</label>
                <input type="text" id="initialLat" value="41.48577"><br>
                <label for="initialLng">Load Longitude:</label>
                <input type="text" id="initialLng" value="-81.7072"><br>
                <label for="initialZoom">Load Zoom:</label>
                <input type="number" id="initialZoom" value="21" min="1"><br>
            </div>
            <button id="updateProjectSettings">Set Current View as Default</button>

            <hr>
            <button id="deleteMarkers">Delete All Markers</button>
            <button id="deleteLaneLines">Delete All Lane Lines</button>
            <button id="clearMap">Clear Map</button>
        </div><button id="loadGeoJsonBtn">&#128194; Load Design .geojson file</button>
        <button id="saveGeoJson">&#128190; Save Design .geojson file</button>
        <input type="file" id="loadGeoJson" style="display: none;">
    </div>

    <div id="offsetModal" class="modal" style="display: none;">
        <div class="modal-content">
            <h3>Generate Offset Lines</h3>
            <label for="offsetDistance">Offset Distance (feet):</label>
            <input type="number" id="offsetDistance" step="1" value="10"><br>
            <label for="numOffsetLines">Number of Offset Lines:</label>
            <input type="number" id="numOffsetLines" step="1" value="1"><br>
            <button id="offsetModalSubmit">Generate</button>
            <button id="offsetModalCancel">Cancel</button>
        </div>
    </div>

    <!-- Leaflet JS and plugins -->
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@turf/turf/turf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.4/leaflet.draw.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/leaflet-editable@1.2.0/src/Leaflet.Editable.js"></script>
    <script src="https://ppete2.github.io/Leaflet.PolylineMeasure/Leaflet.PolylineMeasure.js"></script>
    <script src="https://bbecquet.github.io/Leaflet.PolylineDecorator/dist/leaflet.polylineDecorator.js"></script>
    <script src="https://unpkg.com/leaflet.gridlayer.googlemutant@latest/dist/Leaflet.GoogleMutant.js"></script>
    <script src="js/leaflet.geometryutil.js"></script>
    <script src="js/leaflet-arrowheads.js"></script>
    <script src="js/scripts.js"></script>
    <script src="https://npmcdn.com/leaflet.path.drag/src/Path.Drag.js"></script>
</body>

</html>